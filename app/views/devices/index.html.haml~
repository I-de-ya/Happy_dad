# coding: utf-8

.search
	= form_tag devices_path, :method => 'get' do
		= select_tag :qwerty, options_for_select(@device, @device)
		= text_field_tag :search, params[:search], :placeholder => 'Введите параметры поиска'
		= submit_tag "Найти", :title => nil
%h1.paragraph Список всех приборов
.scroll
	%table
		%tr
			%th= sortable "uniq_number_in_ASOMI", "Уникальный номер в АСОМИ"
			%th= sortable "title", "Наименование СИ"
			%th= sortable "created_at", "Создан"
			%th= sortable "device_type", "Тип СИ"
			%th= sortable "form_of_mr", "Вид МР"
			%th= sortable "inventory_number",  "Инвентарный номер"
			%th= sortable "serial_number", "Заводской номер"
			%th= sortable "status_id", "Статус"
			%th= sortable "mr_unit", "Подразделение МР"
			%th= sortable "location_id", "Местонахождение СИ, рабочая среда"
			%th= sortable "prev_mr_date", "Дата последней МР"
			%th= sortable "next_mr_date", "Дата следующей МР"
			%th= sortable "auto_position.automation_area", "Участок автоматизации"
			%th "Технологический агрегат"
			%th "Позиция"
			%th= sortable "replace_param", "Параметр заменяемости"
			%th "Взаимозаменяемость данного прибора"
			%th ??
			%th ??

		- @devices.each do |device|
			-if @search == nil
				%tr
					%td
						= device.uniq_number_in_ASOMI
						%br
						= (DateTime.now.to_date-device.created_at.to_date).to_i
					%td= link_to device.title, device_path(device)
					%td= device.created_at.to_date
					%td= device.device_type
					%td= device.form_of_mr
					%td= device.inventory_number
					%td= device.serial_number
					%td= #device.status.title
					%td= device.mr_unit
					%td= #device.location.title
					%td= device.prev_mr_date
					%td= device.next_mr_date
					%td= device.auto_position ? device.auto_position.automation_area : "-"
					%td= device.auto_position ? device.auto_position.technological_unit : "-"
					%td= device.auto_position ? device.auto_position.title : "-"
					%td= device.replace_param
					%td= link_to 'Подобрать замену', replacement_candidates_device_path(device)
					%td= link_to 'Редактировать', edit_device_path(device)
					%td= link_to 'Удалить', device, :confirm => 'Вы уверены?', :method => :delete
			- else
				- if device.attributes[@attr].to_s.underscore.downcase == @search.underscore.downcase
					%tr
						%td= device.uniq_number_in_ASOMI
						%td= link_to device.title, device_path(device)
						%td= device.created_at.to_date
						%td= device.device_type
						%td= device.form_of_mr
						%td= device.inventory_number
						%td= device.serial_number
						%td= #device.status.title
						%td= device.mr_unit
						%td= #device.location.title
						%td= device.prev_mr_date
						%td= device.next_mr_date
						%td= device.auto_position ? device.auto_position.automation_area : "-"
						%td= device.auto_position ? device.auto_position.technological_unit : "-"
						%td= device.auto_position ? device.auto_position.title : "-"
						%td= device.replace_param
						%td= link_to 'Подобрать замену', replacement_candidates_device_path(device)
						%td= link_to 'Редактировать', edit_device_path(device)
						%td= link_to 'Удалить', device, :confirm => 'Вы уверены?', :method => :delete
.right
	= link_to 'Новый прибор', new_device_path
Тут должно быть паджинатору: [|<][<<] - 123 из 240 - [>>][>|]_[ 1 [v]]
= will_paginate @devices, :inner_window => 1, :separator => "    ", :renderer => "FancyRenderer"
= select_tag :page, options_for_select([1, 2, 3],@page.to_i)
%p P.S. ?? - это поле возможно будет, а возможно и нет
